<!DOCTYPE html>
<html lang="en">
    <head>
        <!-- Meta, title, CSS, favicons, etc. -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="description" content="">
        <meta name="author" content="">
        <title>Regex Pattern Example</title>
        <!-- Bootstrap core CSS -->
        <link href="css/bootstrap.min.css" rel="stylesheet">
        <!-- Documentation extras -->
        <link href="css/docs.css" rel="stylesheet">
        <link href="css/pygments-manni.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
          <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
        <!-- Favicons -->
        <link rel="apple-touch-icon-precomposed" sizes="144x144" href="assets/ico/apple-touch-icon-144-precomposed.png">
        <link rel="shortcut icon" href="img/favicon.ico">
    </head>
    <body>
        <div class="container bs-docs-container">
            <div class="row">
                <div class="col-md-12" role="main">
                    <!-- Dropdowns ================================================== -->
                    <div class="bs-docs-section">
                        <div class="page-header">
                            <h1 id="validator">Pattern Captures and non captures<small></small></h1>
                        </div>
                        <ul>
                            <li>Pattern captures occur with each set of parenthesis if you don't want parenthesis to capture then start the parenthesis like (?:yourpattern)</li>
                        </ul>
                        <div>
                            <form data-toggle="validator" role="form" id="form">


                                <div class="row">
                                    <div class="col-sm-12">

                                        <!-- Input -->
                                        <div class="form-group has-feedback" >
                                            <label for="regex" class="control-label">Match</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"></span>
                                                <input type="text" id="regex" class="form-control" value="" required>
                                            </div>
                                            <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                            <div class="help-block">Type your regex pattern here</div>
                                        </div>

                                    </div>
                                </div>



                                <!-- MATCH -->
                                <div class="row">

                                    <div class="col-sm-6">

                                        <div class="form-group has-feedback" >
                                            <label for="inputTwitter" class="control-label">Match</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"></span>
                                                <input id="one" type="text" pattern="" class="form-control"  required
                                                    value="capture">
                                            </div>
                                            <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                            <div class="help-block"></div>
                                        </div>

                                        <div class="form-group has-feedback" >
                                            <label for="inputTwitter" class="control-label">Match</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"></span>
                                                <input id="two" type="text" pattern="" class="form-control"  required
                                                    value="AcaptureA">
                                            </div>
                                            <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                            <div class="help-block"></div>
                                        </div>


                                        <div class="form-group has-feedback" >
                                            <label for="inputTwitter" class="control-label">Match</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"></span>
                                                <input id="three" type="text" pattern="" class="form-control"  required
                                                    value="CCcaptureCC">
                                            </div>
                                            <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                            <div class="help-block"></div>
                                        </div>


                                    </div>                                     

                                    <!-- NOT MATCH -->
                                    <div class="col-sm-6">

                                        <div class="form-group has-feedback" >
                                            <label for="inputTwitter" class="control-label">Capture</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"></span>
                                                <input id="onematches" type="text" pattern="capture" class="form-control"  
                                                value="" >
                                            </div>
                                            <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                            <div class="help-block"></div>
                                        </div>


                                        <div class="form-group has-feedback" >
                                            <label for="inputTwitter" class="control-label">Capture</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"></span>
                                                <input id="twomatches" type="text" pattern="capture" class="form-control"  
                                                value="" >
                                            </div>
                                            <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                            <div class="help-block"></div>
                                        </div>



                                        <div class="form-group has-feedback" >
                                            <label for="inputTwitter" class="control-label">Capture</label>
                                            <div class="input-group">
                                                <span class="input-group-addon"></span>
                                                <input id="threematches" type="text" pattern="capture" class="form-control"  
                                                value="" >
                                            </div>
                                            <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                                            <div class="help-block"></div>
                                        </div>


                                    </div>
                                </div>        
                                <button type="submit" class="btn btn-primary" id="submit">
                                        Validate</button>                     
                            </form>

                        </div>
                    </div>   


                </div>


            </div>

        </div>


    </div>


    <!-- Footer
    ================================================== -->

    <footer class="bs-footer" role="contentinfo">

        <div class="container">

        </div>
    </footer>


    <!-- JS and analytics only. -->

    <!-- Bootstrap core JavaScript
================================================== -->

    <!-- Placed at the end of the document so the pages load faster -->

    <script src="js/jquery-1.10.2.min.js"></script>
    <script src="js/bootstrap.3.3.7.min.js"></script>
    <script src="js/validator.js"></script>
    <script src="js/widgets.js"></script>
    <script src="js/application.js"></script>

    <script>
        $(document).ready(function () {

            $('#regex').on('keyup change', function () {
                $regexValue = this.value;
                $('#form').find('input').each(function () {
                    if ($(this).prop('required')) {
                        if (this.id !== "regex"  ) {
                            $regex = undefined;
                            try{
                                $regex = new RegExp($("#regex")[0].value,"g");
                                $regexIsValid = true;
                            } catch(e){
                                $regexIsValid = false;
                            }   

                            if( !this.id.endsWith("matches")){
                                try{
                                    if(typeof $regex !== typeof undefined ){
                                        console.log($regex);
                                        console.log("assigning " + this.id + " a pattern of " + $regexValue);
                                        $(this).attr('pattern', $regexValue);
                                        
                                        try{
                                            //console.log("matches");
                                            $matches = $regex.exec(this.value);
                                            //console.log("this value" + this.value);
                                            //console.log($matches[0]);
                                            //console.log($matches[1]);
                                            $firstMatch = $matches[1];
                                            //$firstMatch = this.value.match($regex)[0];
                                        } catch(e){
                                            $firstMatch = ""
                                        }
                                        
                                        console.log("First capture of " + $regex +" is " + $firstMatch);
                                        $("#"+this.id+"matches").val($firstMatch);
                                    } else {
                                        console.log("Regex is incomplete");
                                        $("#"+this.id+"matches").val("");
                                    }   
                                } catch(e){
                                    console.log("Unable to set value of "+this.id);
                                }
                            
                                
                            }
                            
                            if($regexIsValid){
                                $(this).attr('pattern', $regexValue);
                                $(this).attr('pattern', "[^.]*");   
                            }
                            

                            $('#form').validator('update');
                            $('#form').validator('validate');
                        }                       
                    }
                });
                //$(this).focus();
            });
            
            $('form').validator({
                focus: false,
            }).on('submit', function (e) {
                if(e.isDefaultPrevented()){
                     $('#form').validator('update');
                     $('#form').validator('validate');
                } else {
                    $('#form').find().each(function () {
                        if (this.id !== "regex") {
                            $(this).hide();
                            $(this).empty();
                        }                       
                    
                    });
                    //$('form').validator('destroy');
                    //$('#form').parent().parent().hide();
                    //$('#form')
                    //.parent().parent().parent().Find('submit')
                    $(":submit").parent().append(
                        "<h1 style=\"color:green; font-size: 40px;\">Pass: <pre>"
                        + $("<div />").text($('#regex')[0].value).html()
                        + "</pre></h1>");
                    $(":submit").hide();
                    e.preventDefault();
                    //$('html, body', window.parent.document).animate({scrollTop:0}, 'slow');


                }
            });

            $("form").submit(function(e){
                  $('#form').find().each(function () {
                        if (this.id !== "regex") {
                            $(this).hide();
                            $(this).empty();
                        }                       
                    
                    });
                  e.preventDefault();
            });
            
        });
    </script>

</body>

</html>

